function Beacon(){function e(e){if(!this.sid)return;var t=new Image;var n=["s="+this.sid];for(var r=1;r<arguments.length;r++){n.push(String.fromCharCode(96+r)+"="+encodeURIComponent(arguments[r]))}n.push("n="+Math.random());if(window.location.protocol=="https:"){t.src=["https://qcommons.qunar.com/bc/",e,"?",n.join("&")].join("")}else{t.src=["http://bc.qunar.com/",e,"?",n.join("&")].join("")}}this.sid="";this.f=function(){e.apply(this,["f"].concat(Array.prototype.slice.call(arguments,0)))};this.w=function(){e.apply(this,["w"].concat(Array.prototype.slice.call(arguments,0)))};this.click=this.clk=function(){e.apply(this,["clk"].concat(Array.prototype.slice.call(arguments,0)))}}function versionStatistics(e){var t,n,r,i;try{t=window.top}catch(s){t=window.parent}n=t.location;r=n.origin+n.pathname;i=QNRCorp.USERLOGIN_BEACON;if(i&&e){i.clk("业务线url为"+r+" 登录组件version为"+e)}}function CaptchaVcodeUrl(e,t){this.url="//captcha1.pbs.qunar.com/api/image";this.key="{en7mni(z";this.protocol=e;this.p=t;switch(t){case"login":this.c="ef7d278eca6d25aa6aec7272d57f0a9a";break;case"send_login_code":this.c="ba32d0a158ee9e191234974b30f93d9e";break;case"bind":this.c="21e17f03413cea3f6b19c63864ab9934";break;case"find_password":this.c="d7af51706154fe5b9d7062e938855547";break;case"register":this.c="99b054becba8690183f1f7f57e27a690";break;case"change_contact":this.c="f39dc5488263f5f6763ca961fa28b6ae";break;case"order":this.c="4cf6a64adc3ae2674fc9864bc55ec150";break;default:break}}if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}QNRCorp.USERLOGIN_BEACON=new Beacon;QNRCorp.USERLOGIN_BEACON.sid="3286";QNRCorp.USERLOGIN_BEACON.versionStatistics=versionStatistics;(function(e){function o(){var e=0,t=10;var n=setInterval(function(){var s=window.QDevice;if(e>r){i.state="error";i.error();clearInterval(n);return}if(s){i.state="ready";i.ready();clearInterval(n)}e+=t},t)}function u(e){i.ready=e.ready&&e.ready;i.error=e.error&&e.error}function a(e,t){if(!t){t=e;e=null}var n=window.QDevice;if(n&&typeof n.getDevice=="function"){n.getDevice(function(n){if(n){if(e){e.sessionId=n}t()}else{f(s.SessionIdError)}},"qunar.com")}else{f(s.QDeviceError)}}function f(e){var t=QNRCorp.USERLOGIN_BEACON;t&&t.clk(e)}function l(e,t){if(i.state==="ready"){a(e,t)}else if(i.state==="loading"){u({ready:function(){a(e,t)},error:function(){f(s.QDeviceError)}})}else{f(s.QDeviceError)}}function c(){var e=navigator.userAgent,t=e.match(/MSIE [678].0/);if(t){return true}if(e.indexOf("MSIE 9.0")>-1&&!window.innerWidth){return true}return false}if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}var t=document.createElement("script"),n=function(){},r=5e3,i={state:"loading",ready:n,error:n},s={QDeviceNetError:"用户登录-QDevice不存在[NetError]",QDeviceTimeoutError:"用户登录-QDevice不存在[Timeout("+r+")]",SessionIdError:"用户登录-QDevice获取sessionId失败"};t.type="text/javascript";t.src="https://rmcsdf.qunar.com/js/df.js?org_id=ucenter.login&js_type=0";e(document).ready(function(){document.body.appendChild(t);if(c()){o()}else{t.onload=function(){o()};t.onerror=function(){i.state="error";i.error()}}});QNRCorp.rmcsdf=l})(jQuery);(function(e){if(typeof e.QNRCorp==="undefined"){e.QNRCorp={}}if(typeof e.QNRCorp.lang==="undefined"){e.QNRCorp.lang={}}var t=function(e,t){if(arguments.length!=2){throw new Error("Interface constructor called with "+arguments.length+"arguments, but expected exactly 2.")}this.name=e;this.methods=[];for(var n=0,r=t.length;n<r;n++){if(typeof t[n]!=="string"){throw new Error("Interface constructor expects method names to be "+"passed in as a string.")}this.methods.push(t[n])}};t.ensureImplements=function(e){if(arguments.length<2){throw new Error("Function Interface.ensureImplements called with "+arguments.length+"arguments, but expected at least 2.")}for(var n=1,r=arguments.length;n<r;n++){var i=arguments[n];if(i.constructor!==t){throw new Error("Function Interface.ensureImplements expects arguments "+"two and above to be instances of Interface.")}for(var s=0,o=i.methods.length;s<o;s++){var u=i.methods[s];if(!e[u]||typeof e[u]!=="function"){throw new Error("Function Interface.ensureImplements: object "+"does not implement the "+i.name+" interface. Method "+u+" was not found.")}}}};var n=function(e,t){var n=function(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e;e.superclass=t.prototype;if(t.prototype.constructor==Object.prototype.constructor){t.prototype.constructor=t}};QNRCorp.lang.Interface=t;QNRCorp.lang.extend=n})(this);(function(e){if(typeof e.QNRCorp==="undefined"){e.QNRCorp={}}if(typeof e.QNRCorp.util==="undefined"){e.QNRCorp.util={}}var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};var n=function(e,n,r,i){n=n||"&";r=r||"=";if(e===null){e=undefined}if(typeof e==="object"){return Object.keys(e).map(function(i){var s=encodeURIComponent(t(i))+r;if(Array.isArray(e[i])){return e[i].map(function(e){return s+encodeURIComponent(t(e))}).join(n)}else{return s+encodeURIComponent(t(e[i]))}}).join(n)}if(!i)return"";return encodeURIComponent(t(i))+r+encodeURIComponent(t(e))};var r=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var i=function(e,t,n,i){t=t||"&";n=n||"=";var s={};if(typeof e!=="string"||e.length===0){return s}var o=/\+/g;e=e.split(t);var u=1e3;if(i&&typeof i.maxKeys==="number"){u=i.maxKeys}var a=e.length;if(u>0&&a>u){a=u}for(var f=0;f<a;++f){var l=e[f].replace(o,"%20"),c=l.indexOf(n),h,p,d,v;if(c>=0){h=l.substr(0,c);p=l.substr(c+1)}else{h=l;p=""}d=decodeURIComponent(h);v=decodeURIComponent(p);if(!r(s,d)){s[d]=v}else if(Array.isArray(s[d])){s[d].push(v)}else{s[d]=[s[d],v]}}return s};QNRCorp.util.encode=QNRCorp.util.stringify=n;QNRCorp.util.decode=QNRCorp.util.parse=i})(this);(function(e){function i(e,n,r,i,o){var u=[];var a=s(e,n,i,o),f="ifr"+o,l="form"+o;u.push('<form id="'+l+'" target="'+f+'" action="'+a+'" method="POST">');for(var c in r){if(r.hasOwnProperty(c)){u.push('<input type="text" name="'+c+'" value="'+r[c]+'" />')}}u.push('<input id="hostname" name="" value="'+t+'" />');u.push('<input id="proxypath" name="" value="'+n+'" />');u.push('<input id="crosscall" name="" value="'+i+'" />');u.push('<input id="frameid" name="frameid" value="'+o+'" /></form>');u.push('<iframe name="'+f+'" id="'+f+'" src="javascript:false"></iframe>');return u.join("")}function s(e,r,i,s){var o=t,u=e.indexOf("#"),a=[e];var f=u<0?"#":e.substr(u);a[a.length]=f;if(f.replace(/#/g,"").length){a.push("&")}var l=n.location.protocol?n.location.protocol:"https:";a[a.length]="crosspath="+encodeURIComponent(l+"//"+o+"/"+r);a[a.length]="&";a[a.length]="crosscall="+encodeURIComponent(i);a[a.length]="&";a[a.length]="frameid="+s;return a.join("")}if(typeof e.QNRCorp==="undefined"){e.QNRCorp={}}if(typeof e.QNRCorp.util==="undefined"){e.QNRCorp.util={}}var t=e.location.host,n=e.document;var r=function(t,r,s,o){if(!t){return}o=o||{};r=r||{};var u=o.timeout||0,a="crossDomainPostUserCenter"+(new Date).getTime(),f=false;var l=function(){if(f){return}if(o.ontimeout){o.ontimeout(t,r,s,a)}h()};var c=function(e){if(f){return}if(o.onsuccess){o.onsuccess(e)}h()};var h=function(){var t=n.getElementById(a);t.parentNode.removeChild(t);f=true;e[a]=null};e[a]=c;var p=i(t,s,r,a,a),d=n.createElement("div");d.style.display="none";d.id=a;d.innerHTML=p;n.body.appendChild(d);var v=n.getElementById("form"+a);v.submit();if(u){setTimeout(l,u)}return a};QNRCorp.util.crossDomainPostUserCenter=r})(this);(function(e){if(typeof e.QNRCorp==="undefined"){e.QNRCorp={}}if(typeof e.QNRCorp.util==="undefined"){e.QNRCorp.util={}}var t=function(){};t.createXhrObject=function(){if(typeof XMLHttpRequest==="undefined"){return null}var e=new XMLHttpRequest;if("withCredentials"in e){}else if(typeof XDomainRequest!="undefined"){e=null}else{e=null}return e};t.request=function(e,t,n,r,i){if(!e){throw new Error("CrossDomainXhr: xhr is not an XHR object.");return}if("withCredentials"in e){e.open(t,n,true);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.withCredentials=true}else if(typeof XDomainRequest!="undefined"){e.open(t,n)}e.onload=function(){i.success(JSON.parse(e.responseText))};e.onerror=function(){i.failure(e.status)};var s=QNRCorp.util.stringify(r);e.send(s)};QNRCorp.util.CrossDomainXhr=t})(this);(function(){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}var e={};e.register=function(t){if(t.obj&&typeof t.obj==="object"){e.execute(t)}};e.execute=function(t){$.each(t,function(n,r){if(n.substring(0,3)==="on_"){e.bind(t.obj,n.substring(3),r)}})};e.bind=function(e,t,n){if(e&&typeof n==="function"){e.bind(t,n)}};QNRCorp.Event=e})();(function(){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}var e={};e.regexp={username:/^.{2,100}$/,mobilePassword:/^.{4,30}$/,password:/^[0-9a-zA-Z\~\!\@\#\$%\^&\*\(\)\-\_\=\+\;\:\'\"\,\<\.\>\/\?\\]{4,30}$/,mobile:/^1[0-9]{10}$/,email:/^[a-zA-Z0-9_+.-]+@([a-zA-Z0-9-]+\.)+[a-z0-9]{2,4}$/i,vcode:/^[0-9a-zA-Z]{4}$/,limit:{emailMin:5,emailMax:80}};e.util={testString:function(t,n){t=typeof t=="string"&&e.util.trim(t)||"";return n.test(t)},validUsername:function(t){return e.util.testString(t,e.regexp.username)},validMobile:function(t){return e.util.testString(t,e.regexp.mobile)},validEmail:function(t){return t.length>=e.regexp.limit.emailMin&&t.length<=e.regexp.limit.emailMax&&e.util.testString(t,e.regexp.email)},validPassword:function(t){return e.util.testString(t,e.regexp.password)},validMobilePassword:function(t){return e.util.testString(t,e.regexp.mobilePassword)},validVcode:function(t){return e.util.testString(t,e.regexp.vcode)},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},getCharLength:function(e){if(typeof e!="string")return 0;var t=0;for(var n=0;n<e.length;n++){if(e.charCodeAt(n)>0&&e.charCodeAt(n)<128){t+=1}else{t+=2}}return t}};QNRCorp.Tools=e})();(function(e){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}var t=function(t){var n={name:"QunarPopBox",title:"登 录",width:"352px",content:"",skin:"",hasBg:true,callback:false,proxy:false};var t=e.extend(n,t);this.options=t};t.prototype={init:function(){var t=this.options.name;this.rm();this.render();this.container=e("#"+t);this.mask=e("#"+t+"BG");this.closeBtn=this.container.find("#"+t+"ClosePop");this.showBox()},render:function(){var t=this.options.name;var n=e(this.options.content);this._dom=n;e("body").append(n);e("#"+t).show();this.showBg()},close:function(){this.rm();e(window).unbind("scroll.QNRCorp");var t=this.options.callback;if(t&&t.close){t.close.call(null)}},rm:function(){var t=this.options.name;var n=t+"BG";if(document.getElementById(n))e("#"+n).remove();if(document.getElementById(t))e("#"+t).remove()},showBg:function(){if(this.options.hasBg){var t=this.options.name;var n=t+"BG";var r=!!window.ActiveXObject&&!window.XMLHttpRequest;if(r){var i='<iframe frameborder="0" src="javascript:false" style="filter:progid:DXImageTransform.Microsoft.Alpha(opacity:0);position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:-1"></iframe>';var s=e(document);var o='<div class="q_widget_login_mask" id="'+n+'" style="position:absolute;height:'+s.height()+"px;width:"+s.width()+'">'+i+"</div>";e("body").append(o)}else{var o='<div class="q_widget_login_mask" id="'+n+'" style="position:fixed"></div>';e("body").append(o)}}},showBox:function(){var t=this;t.relocate();e(window).resize(function(){t.relocate()});e(window).bind("scroll.QNRCorp",function(){t.relocate()});t.closeBtn.bind("click",function(){t.close()})},relocate:function(){var t=this;var n=t.container.width(),r=t.container.height();var i=window.pageYOffset||document.documentElement.scrollTop||e(window).scrollTop()||0;var s=(e(window).width()-n)*.5;var o=!!window.ActiveXObject&&!window.XMLHttpRequest;if(o){t.container.css("position","absolute");i=(e(window).height()-r)*.5+e(window).scrollTop();s=s+e(window).scrollLeft();t.container.css({top:i+"px",left:s+"px",width:t.options.width})}else{i=0;s=0;t.container.css("position","fixed");var u=e("body");var a=window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight;a=a<r?0:(a-r)*.5;i=Math.min(u.height()-r,i+a);var f=window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.offsetWidth;f=f<n?0:(f-n)*.5;s=Math.min(u.width()-n,s+f);t.container.css({top:i+"px",left:s+"px",width:this.options.width})}}};QNRCorp.PopBox=t})(jQuery);(function(e){if(typeof e.QNRCorp==="undefined"){e.QNRCorp={}}if(typeof e.QNRCorp.login==="undefined"){e.QNRCorp.login={}}var t={};var n="user.qunar.com";t.getVerifyCode="//"+n+"/webApi/logincode.jsp";t.loginNormal="//"+n+"/webApi/logins.jsp";t.loginMobile="//"+n+"/webApi/logincodeverify.jsp";t.sendMobileCode="//"+n+"/userExt/sendMobileCode.jsp";t.userExtBindAndLogin="//"+n+"/userExt/userExtBindAndLogin.jsp";t.updateUserMobileSure="//"+n+"/webApi/updateUserMobileSure.jsp";t.updateUserTemp="//"+n+"/webApi/updateUserTemp.jsp";t.updateUseCommit="//"+n+"/webApi/updateUseCommit.jsp";t.popRegSendSms="//"+n+"/webApi/popRegSendSms.jsp";t.popRegConfirm="//"+n+"/webApi/popRegConfirm.jsp";var r=new QNRCorp.lang.Interface("AjaxHandler",["getVerifyCode","loginNormal","loginMobile"]);var i=function(e,t){QNRCorp.lang.Interface.ensureImplements(this,r);this.proxy=e;this.domain=t};i.prototype={handler:function(e,t,r){var i="https:";if(e.substring(0,2)!="//"){i=""}this.domain&&(e=e.replace(n,this.domain));var s=QNRCorp.util.CrossDomainXhr.createXhrObject();if(s){QNRCorp.util.CrossDomainXhr.request(s,"post",i+e,t,r)}else{var o=this.proxy;if(o&&this.proxy.indexOf("?")>-1){o=o+"&t="+(new Date).getTime()}else if(o&&this.proxy.indexOf("?")==-1){o=o+"?t="+(new Date).getTime()}if(e.indexOf("?")>-1){e=e+"&"}else if(e.indexOf("?")==-1){e=e+"?"}QNRCorp.util.crossDomainPostUserCenter(i+e+"callbacktype=2",t,o||"/proxy.htm",{onsuccess:r.success})}},getVerifyCode:function(e,n){this.handler(t.getVerifyCode,e,n)},loginNormal:function(e,n){this.handler(t.loginNormal,e,n)},loginMobile:function(e,n){this.handler(t.loginMobile,e,n)},sendMobileCode:function(e,n){this.handler(t.sendMobileCode,e,n)},userExtBindAndLogin:function(e,n){this.handler(t.userExtBindAndLogin,e,n)},updateUserMobileSure:function(e,n){this.handler(t.updateUserMobileSure,e,n)},updateUserTemp:function(e,n){this.handler(t.updateUserTemp,e,n)},updateUseCommit:function(e,n){this.handler(t.updateUseCommit,e,n)},popRegSendSms:function(e,n){this.handler(t.popRegSendSms,e,n)},popRegConfirm:function(e,n){this.handler(t.popRegConfirm,e,n)}};QNRCorp.login.LoginHandler=i;QNRCorp.login.url=t})(this);(function(){function e(e){var t=e.notice?'<div class="active-ts"><i class="login_icon login_icon_cue"></i><span>'+e.notice+"</span></div>":"";var n=e.notice?'style="padding:15px 0 30px 0;_padding:0;_margin:15px 0 30px 0;"':"";var r='<div class="'+e.className+'" style="width:'+e.width+';" id="'+e.name+'">'+'<div class="login_content">'+'<div class="login_content_head">'+'<span>绑定手机号码</span><span class="login_close login_icon" id="QunarPopBoxClosePop">关闭</span>'+"</div>"+t+'<div class="login_content_body clrfix " '+n+">"+'<div class="login_regular">'+'<form method="post" class="reg_form">'+"<table><tbody>"+"<tr>"+"<td>密码</td>"+"<td>"+'<div class="login_phone bd_gray">'+'<label class="uin_tips">请输入密码</label>'+'<div class="inputouter inputouter-icon">'+'<span class="login_icon login_icon_pass"></span> '+'<input type="password" autocomplete="off" name="password" class="txt-login-input">'+"</div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+'<td><div class="p_t_20">手机号</div></td>'+"<td>"+'<div class="login_phone bd_gray p_t_20">'+'<label class="uin_tips">请输入手机号</label>'+'<div class="inputouter inputouter-icon">'+'<span class="login_icon login_icon_name"></span>'+'<input type="text" maxlength="11" name="mobile" class="txt-login-input">'+"</div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td>"+'<div class="p_t_20">动态码</div>'+"</td>"+"<td>"+'<div class="login_check_code clrfix">'+'<label class="uin_tips">请输入动态码</label>'+'<div class="inputouter txt_login_ym inputouter-icon">'+'<span class="login_icon login_icon_pass"></span> '+'<input type="text" name="randcode" class="txt-login-input txt_igin_ico">'+"</div>"+'<span active-type="getVerifyCode"><a href="javascript:;" class="f_r login_icon login_btn_blue">获取手机动态码</a></span>'+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td></td>"+"<td>"+'<div style="display:none;" active-type="notice" class="login_notice reg_right">'+'<i class="login_icon login_icon_error"></i>验证码输入错误，请重新输入'+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td></td>"+"<td>"+'<div class="login_submit">'+'<button active-type="bind" type="submit" class="login_icon login_btn_orange">提 &nbsp; 交</button>'+"</div>"+"</td>"+"</tr>"+"</tbody></table>"+"</form>"+"</div>"+"</div>"+"</div>"+"</div>";return r}if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}var n=QNRCorp.Tools;var r=QNRCorp.Event;var i=function(e){this.options=e};i.prototype={init:function(){var t=this.options;t.name="QunarPopBox";t.mask=true;t.className="q_widget_login";t.content=e(t);var n=new QNRCorp.PopBox(t);n.init();this.createDom();this.addEvent()},createDom:function(){this.dom={};this.dom.obj=$("#QunarPopBox");this.dom.password=this.dom.obj.find("input[name='password']");this.dom.mobile=this.dom.obj.find("input[name='mobile']");this.dom.randcode=this.dom.obj.find("input[name='randcode']");this.dom.notice=this.dom.obj.find("div[active-type='notice']");this.dom.input=this.dom.obj.find("input[name='mobile'],input[name='password'],input[name='randcode']");this.dom.label=this.dom.obj.find(".uin_tips");this.dom.getVerifyCode=this.dom.obj.find("span[active-type='getVerifyCode']");this.dom.bind=this.dom.obj.find("button[active-type='bind']");this.dom.count=this.dom.obj.find("[data-type='count']");this.msg={};this.msg.mobile="请输入正确的手机号码";this.msg.password="请输入正确的密码格式";this.msg.secVcode="没收到？再获取"},showError:function(e){this.dom.notice.html('<i class="login_icon login_icon_error"></i><span>'+e+"</span>").show()},showWarn:function(e){this.dom.notice.html('<i class="login_icon login_icon_warning"></i><span>'+e+"</span>").show()},checkPassword:function(){var e=this.dom.password.val();if(!n.util.validPassword(e)){this.showError(this.msg.password);return false}else{this.dom.notice.html("").hide();return true}},checkMobile:function(){var e=this.dom.mobile.val();if(!n.util.validMobile(e)){this.showError(this.msg.mobile);return false}else{this.dom.notice.html("").hide();return true}},addEvent:function(){this.addInputEvent();this.addInputBlurEvent();this.addButtonEvent()},addInputEvent:function(){var e=this;r.register({obj:this.dom.input,on_focus:function(e){var t=$(this).parent().parent().find("label");t.addClass("focus")},on_keydown:function(t){var n=$(this).parent().parent().find("label");if($(this).val()!=""){n.hide()}if(t.which==13){e.dom.bind.trigger("click")}},on_keyup:function(e){var t=$(this).parent().parent().find("label");if($(this).val()!=""){t.hide()}},on_change:function(e){var t=$(this).parent().parent().find("label");if($(this).val()!=""){t.hide()}}});r.register({obj:this.dom.label,on_click:function(e){$(this).parent().find("input[type='text'],input[type='password']").trigger("focus")}})},addInputBlurEvent:function(){var e=this;r.register({obj:this.dom.input,on_blur:function(t){var n=$(this).parent().parent().find("label");if($(this).val()===""){n.show();n.removeClass("focus")}else{var r=$(this).attr("name");if(r==="mobile"){e.checkMobile()}else if(r==="password"){e.checkPassword()}}}})},addButtonEvent:function(){var e=this;r.register({obj:this.dom.getVerifyCode,on_click:function(t){if(!e.checkPassword()){return}if(!e.checkMobile()){return}e.getVerifyCode()},on_mouseover:function(t){e.dom.input.unbind("blur")},on_mouseout:function(t){e.addInputBlurEvent()}});r.register({obj:this.dom.bind,on_click:function(t){t.preventDefault();e.bindMobile()},on_mouseover:function(t){e.dom.input.unbind("blur")},on_mouseout:function(t){e.addInputBlurEvent()}})},getVerifyCode:function(){function n(){var n=$("#QunarPopBox").find("[data-type='count']");var r=n.html();var i=parseInt(r);i=i-1;if(i>0){n.html(i)}else{e.dom.getVerifyCode.html('<a class="f_r login_icon login_btn_blue" href="javascript:;">'+e.msg.secVcode+"</a>");clearInterval(t);e.dom.getVerifyCode.bind("click",function(){e.getVerifyCode()})}}var e=this;var r={success:function(r){if(r.ret===true){e.dom.getVerifyCode.html('<span class="f_r login_btn_gray"><span data-type="count">59</span>秒后重新获取</span>');t=setInterval(n,1e3);e.dom.getVerifyCode.unbind();e.dom.notice.hide().html("")}else{if(r.errcode===11002){e.showWarn(r.errmsg);e.updateUserTemp()}else{e.showError(r.errmsg)}}},failure:function(e){throw new Error("failure: api status is "+e)}};var i={};i.password=this.dom.password.val();i.mobile=this.dom.mobile.val();var s=new QNRCorp.login.LoginHandler(this.options.proxy);s.updateUserMobileSure(i,r)},updateUserTemp:function(){function n(){var n=$("#QunarPopBox").find("[data-type='count']");var r=n.html();var i=parseInt(r);i=i-1;if(i>0){n.html(i)}else{e.dom.getVerifyCode.html('<a class="f_r login_icon login_btn_blue" href="javascript:;">'+e.msg.secVcode+"</a>");clearInterval(t);e.dom.getVerifyCode.bind("click",function(){e.getVerifyCode()})}}var e=this;var r={success:function(r){if(r.ret===true){e.dom.getVerifyCode.html('<span class="f_r login_btn_gray"><span data-type="count">59</span>秒后重新获取</span>');t=setInterval(n,1e3);e.dom.getVerifyCode.unbind();e.dom.notice.hide().html("")}else{e.showError(r.errmsg)}},failure:function(e){throw new Error("failure: api status is "+e)}};var i={};i.password=this.dom.password.val();i.mobile=this.dom.mobile.val();var s=new QNRCorp.login.LoginHandler(this.options.proxy);s.updateUserTemp(i,r)},bindMobile:function(){var e=this;var t={success:function(t){if(t.ret===true){var n=t.data;var r=e.options.callback;if(r){if(r.success){r.success.call(null,n)}else{r.call(null,n)}}var i=new QNRCorp.PopBox(this.options);i.close()}else{e.showError(t.errmsg)}},failure:function(e){throw new Error("failure: api status is "+e)}};var n={};n.vcode=this.dom.randcode.val();var r=new QNRCorp.login.LoginHandler(this.options.proxy);r.updateUseCommit(n,t)}};QNRCorp.BindMobile=i})();CaptchaVcodeUrl.prototype.getAddr=function(){var e=this.protocol+this.url;if(this.protocol=="https:"){e=this.protocol+"//user.qunar.com/captcha/api/image"}if(this.p=="register"){return e+"?k="+this.key+"&p=ucenter_popup_"+this.p+"&c="+this.c}else if(this.p=="login"){return e+"?k="+this.key+"&p=ucenter_"+this.p+"&c="+this.c}};(function(e){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}if(typeof window.QNRCorp.MultiLanguage==="undefined"){window.QNRCorp.MultiLanguage={}}var t="Chinese";var n={LoginTitle:"登录",LoginType:{normal:"账号登录",mobile:"短信验证码登录"},LoginInputTip:{normal:{username:"手机号/邮箱/用户名",password:"请输入密码"},mobile:{username:"请输入手机号",password:"请输入验证码"},halfLogin:{count:"您目前已登录账号",pswTip:"为保障安全，请输入密码确认",vcodeTip:"为保障安全，请输入手机动态码"},Vcode:{content:"请输入验证码",imgTip:"看不清？换一个",changeVcode:"换一张"}},LoginRemeber:{loginAuto:"三个月内自动登录",remeberPsw:"忘记密码？"},ButtonVal:{getVerifyCode:"获取验证码",count:"秒后重发",login:"登&nbsp;&nbsp;&nbsp;&nbsp;录",confirm:"确&nbsp;&nbsp;&nbsp;&nbsp;认"},errorTip:{normal:{username:{content:"请输入注册手机或邮箱或用户名"},password:{empty:"请输入密码",content:"请输入正确的密码格式"},login:{content:"登录名或密码错误"},Vcode:{empty:"请输入图片验证码",content:"验证码错误"}},mobile:{username:{content:"请输入注册的手机号码"},VerifyCode:{empty:"请输入获取的动态密码",content:"动态码已经失效"},register:"该手机号还未注册，"}},UseOtherLogin:"使用其他账号登录",Register:"免费注册"};window.QNRCorp.MultiLanguage[t]=n})(jQuery);(function(e){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}if(typeof window.QNRCorp.MultiLanguage==="undefined"){window.QNRCorp.MultiLanguage={}}var t="English";var n={LoginTitle:"Login",LoginType:{normal:"Login",mobile:"SMS Login"},LoginInputTip:{normal:{username:"Mobile/Email/Username",password:"Password"},mobile:{username:"Mobile",password:"SMS code"},halfLogin:{count:"Already Logged In:",pswTip:"For the security factor, please input your password",vcodeTip:"For the security factor,please input Vcode"},Vcode:{content:"Verification Code",imgTip:"Not sure? get another",changeVcode:""}},LoginRemeber:{loginAuto:"Remember Me",remeberPsw:"Forgot Password?"},ButtonVal:{getVerifyCode:"Get SMS code",count:"seconds",login:"Login",confirm:"Confirm"},errorTip:{normal:{username:{content:"Please input your registered mobile / email / username"},password:{empty:"Please input your password",content:"Incorrect password format"},login:{content:"Incorrect username or password"},Vcode:{empty:"Please input verification code printed on the image",content:"Incorrect verification code"}},mobile:{username:{content:"Please input registered mobile"},VerifyCode:{empty:"Please input the SMS security code you got right now",content:"The SMS security code has expired"},register:"The mobile hasn't been registered yet,"}},UseOtherLogin:"Login another account",Register:"Join Free"};window.QNRCorp.MultiLanguage[t]=n})(jQuery);(function(e){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}if(typeof window.QNRCorp.LoginPopError==="undefined"){window.QNRCorp.LoginPopError={}}var t="Chinese";var n={0:"操作失败",11001:"用户名已存在",11002:"手机号码已存在",11003:"邮件地址已存在",11004:"验证码错误",11005:"手机验证码错误",11006:"邮件验证码错误",11007:"用户开通类型错误",11008:"激活码错误",11009:"用户已存在",11010:"昵称已存在",11011:"昵称含有敏感词",11012:"加密信息错误",12001:"参数格式错误",12002:"用户名格式错误",12003:"密码格式错误",12004:"两次密码不一致",12034:"用户名不能作为密码",12035:"该密码不安全，不可使用",12005:"手机号码格式错误",12045:"手机号查询结果有误",12006:"邮件地址格式错误",12007:"昵称格式错误",12008:"不能用手机作为用户名",12009:"注册手机/邮箱与用户名不匹配",12010:"请选择格式正确的图像文件",12011:"原始图像文件大小不能超过2M",12012:"参数错误",12013:"参数长度错误",12014:"未获取到登录用户信息",12015:"参数太长",12016:"联系人的ID为空",12017:"联系人名字为空",12018:"用户来源不合规则",12019:"购票类型不合规则",12020:"生日不合规则,YYYY-mm-dd",12021:"邮编不合规则",12022:"证件类型不合规则",12023:"证件有效截止日期不合规则,YYYY-mm-dd",12024:"发票类型不合规则",12025:"联系人性别不合规则",12026:"该联系人已经填写身份证",12027:"已经存在同名同证件类型及证件号码的联系人",12028:"已经存在同名同手机号码的联系人",12029:"用户性别修改错误",12030:"证件超过允许的最大数目",12031:"地址超过允许的最大数目",12032:"发票超过允许的最大数目",12033:"常旅卡超过允许的最大数目",12034:"联系人姓名格式不符合规则",12036:"解绑手机前，请先为账号绑定邮箱",12037:"账号存在安全风险，请使用手机号找回密码",21001:"手机验证码超出一天最大发送次数",21002:"邮箱验证码超出一天最大发送次数",21003:"验证码重试超出最大次数",21004:"超过当日最大修改次数",21005:"超过当日最大重试次数",21006:"用户不存在",21007:"密码错误",21008:"用户被封禁",21009:"用户状态错误",21010:"账户已锁定，请24小时后再试",21011:"注册量超过最大数，请明天再试",21012:"绑定的去哪儿用户不存在",21013:"绑定的去哪儿用户未激活",21014:"去哪儿用户已绑定",21015:"第三方用户不存在",21016:"第三方用户已经绑定",21017:"操作次数超过最大限制数",21018:"账户已被激活",21019:"激活码次数超过一天最大限制数",21020:"获取激活码过于频繁,请15分钟后重试",21021:"激活码已失效超过24小时",21022:"用户名或密码错误",21030:"密码错误",21023:"激活码错误次数超过限制,请重新获取激活码",21024:"获取激活码过于频繁,请一分钟后重试",21025:"为了您的账号安全,请重新<a href='https://user.qunar.com/sensitive/forgotpwd.jsp'>设置密码</a>",21026:"获取激活码过于频繁,请1小时后重试",21027:"激活码已失效",21028:"您注册过于频繁为了保护您的账户安全，您不能邮箱注册，请刷新页面",21029:"您注册过于频繁为了保护您的账户安全，您不能使用手机注册，请刷新页面",21032:"二维码未扫描",21033:"原手机号码错误",21034:"原绑定邮箱有误",21035:"风险账号，需手机动态密码登录",22001:"手机验证码发送过于频繁",22002:"邮箱验证码发送过于频繁",22003:"账户已锁定，请10分钟后再试",22004:"注册频繁已锁定，请10分钟后再试",22005:"手机号码没有修改",22006:"邮箱没有修改",22007:"找回密码过于频繁,请一分钟后再试",22013:"找回密码超过一天最大次数",22008:"重置密码错误次数过于频繁",22009:"修改手机号码过于频繁,请一分钟后再试",22011:"修改手机号码超过一天最大次数",22010:"修改邮箱过于频繁",22012:"修改的用户名与登录的用户名不一致",22018:"错误次数超限，请24小时后再试",22019:"错误次数超限，请24小时后再试",31001:"未知错误",31002:"用户绑定失败",31003:"找回密码失败",31004:"修改邮箱失败",31005:"修改手机号码失败",31006:"数据操作失败",31007:"未查询到相关数据",31008:"内部数据错误",31009:"数据读写错误",31010:"接口访问错误",31011:"IP禁止接口访问受限",31012:"未知主机地址错误",31013:"网络连接超时",31014:"读取或接受套接字时超时",31015:"请不要使用雅虎中国邮箱，以免带来不便。",22014:"密码错误次数超过限制",22015:"请求已过期",22016:"用户没有手机和邮箱",22030:"修改的手机,非登录用户手机",22031:"请使用手机注册",22017:"国际手机验证码发送超出一天最大发送次数",22032:"手机密码用户，请使用去哪儿客户端扫码登录"};window.QNRCorp.LoginPopError[t]=n})(jQuery);(function(e){if(typeof window.QNRCorp==="undefined"){window.QNRCorp={}}if(typeof window.QNRCorp.LoginPopError==="undefined"){window.QNRCorp.LoginPopError={}}var t="English";var n={0:"error",11001:"The username has been registered already",11002:"The mobile has been registered already",11003:"The email has been registered already",11004:"Incorrect verificaiton code",11005:"Incorrect SMS code",11006:"Incorrect email verificaiton code",11007:"Incorrect registeration type",11008:"Incorrect activation code",11009:"The user has existed now",11010:"The nickname has been registered already",11011:"There are some words which couldn't be used in nickname",11012:"Incorrect encryption infomation",12001:"Incorrect format of the parameters",12002:"Incorrect format of the username",12003:"Incorrect format of the password",12004:"The repeat of password doesn't match the password you inputed",12034:"The password cannot be the same to the username",12035:"The password is not safe enough, please input another",12005:"Incorrect format of the mobile",12045:"Cannot find the result when querying the mobile",12006:"Incorrect format of the username",12007:"Incorrect format of the nickname",12008:"The password cannot be the same to the mobile",12009:"The registered mobile / email doesn't match the username",12010:"Sorry, we don't accept the format of this image",12011:"Sorry, we cannot accept the image file larger the 2MB at this point",12012:"Incorrect parameters",12013:"Incorrect length of parameters",12014:"Cannot get the logged in user infomation",12015:"The parameters are too long to accept",12016:"The ID of the contact person is null",12017:"The name of the contact person is null",12018:"The source of this user is irregular",12019:"The type for buying tickets this time is irregular",12020:"The format of the birthday is irregular, please follow: YYYY-MM-DD",12021:"The zipcode is irregular",12022:"The type of certificate is iregular",12023:"The expire date format of this certificate is irregular, please follow: YYYY-MM-DD",12024:"The type of invoice is irregular",12025:"The gender of the contact person is irregular",12026:"The contact has inputed the ID certificate",12027:"There has been a contact person who has the same certificate",12028:"There has been a contact person who has the same name and same mobile",12029:"An error happened when editing the user's gender",12030:"You have submit more certificates than the maximum number",12031:"You have submit more addresses than the maximum number",12032:"You have submit more invoices than the maximum number",12033:"You have submit more frequently-used contact people than the maximum number",12034:"The format of contact person is irregular",12036:"Please bind an email address before you unbind the mobile",12037:"Your account is under security risk, please find back your password with your mobile",21001:"You have exceeded the limitation for everyday's SMS code sending",21002:"You have exceeded the limitation for everyday's SMS code sending",21003:"You have exceeded the limitation for the maximum reinputing verificaiton code",21004:"You have exceeded the limitation for the maximum everyday's editing",21005:"You have exceeded the limitation for the maximum everyday's retrying",21006:"This user doesn't exist",21007:"Incorrect password",21008:"This user has been banned",21009:"Incorrect user status",21010:"This user has been locked, please try again after 24h",21011:"The registeration has exceeded the maximum limitation, please try again tomorrow",21012:"The binded user of Qunar.com doesn't exist",21013:"The binded user of Qunar.com hasn't been activated",21014:"The user of Qunar.com has been binded already",21015:"The third-party user doesn't exist",21016:"The third-party user has been binded already",21017:"You have exceeded the limitation for everyday's operations",21018:"The user has been activated",21019:"The activation code has exceeded everyday's maximum limitation",21020:"Too frequently getting the activation codes, please try again after 15min",21021:"The activation code has expired for more than 24h",21022:"Incorrect username or password",21030:"Incorrect password",21023:"You have exceeded the maximum limitation when inputing wrong activation codes, please get a new activation code",21024:"Too many attempts, please try again later",21025:"The password is not safe enough, please <a href='https://user.qunar.com/sensitive/forgotpwd.jsp'>reset your password</a>",21026:"Too frequently getting the activation codes, please try again after 1 hour",21027:"The activation code has expired",21028:"Too frequent registeration. You cannot register with this email, please refresh this page",21029:"Too frequent registeration. You cannot register with this mobile, please refresh this page",21032:"The QR-code has been scanned",21033:"Incorrect former mobile",21034:"Incorrect former email",21035:"Risky account, please login with SMS code",22001:"Too frequently getting SMS code",22002:"Too frequently getting email verificaiton code",22003:"This user has been locked, please try again after 10 min",22004:"This user has been locked fro too frequent registeration, please try again after 24h",22005:"The mobile hasn't been edited",22006:"The email hasn't been edited",22007:"Too frequently finding password back, please try again after 1 min",22013:"You have exceeded the limitation for everyday's finding password back",22008:"Too frequently reseting password",22009:"Too frequently editing mobile, please try again after 1 min",22011:"You have exceeded the limitation for everyday's edting mobile",22010:"Too frequently edting email",22012:"The edited username is not the same to the login one",22018:"You have exceeded the maximum of error, please try again after 24h",22019:"You have exceeded the maximum of error, please try again after 24h",31001:"Unknown Error",31002:"Failed when binding this user",31003:"Failed when finding password back",31004:"Failed when editing email",31005:"Failed when editing mobile",31006:"Failed when opeating data",31007:"Cannot find relevant data",31008:"Internal data error",31009:"Error happened when I/O data",31010:"Error happened when requesting the APIs",31011:"This IP is Limited to request the APIs",31012:"Error for unknown host address",31013:"Time out when conneting to the Internet",31014:"Time out when receiving socket",31015:"In case of any inconvenience, DO NOT use the yahoo.cn email",22014:"You have exceeded the maximum for inputing wrong passwords",22015:"The request has expired",22016:"The user doesn't have mobile and email",22030:"The edited mobile is not the currently logged in user",22031:"Please register with mobile",22017:"You have exceeded the maximum for getting the International SMS codes",22032:"Scan code with your app to login"};window.QNRCorp.LoginPopError[t]=n})(jQuery);(function(e){function n(e){var t=e.notice?'<div class="active-ts"><i class="login_icon login_icon_cue"></i><span>'+e.notice+"</span></div>":"";var n=e.mobile?"bd_gray_bag":"";var r=e.mobile?'readonly value="'+e.mobile+'"':"";var i=e.notice?'style="padding:15px 0 30px 0;_padding:0;_margin:15px 0 30px 0;"':"";if(e.type==="perfect"){n="";r=e.mobile?'value="'+e.mobile+'"':""}var s=e.logFlag?'<div class="fieldset clrfix"><a class="f_r btn-gotologin" href="javascript:;">登录</a></div>':"";var o='<div class="'+e.className+'" style="" id="'+e.name+'">'+'<div class="login_content">'+'<div class="login_content_head">'+e.title+' <span class="login_close login_icon" id="'+e.name+'ClosePop">关闭</span></div>'+t+'<div class="login_content_body clrfix" '+i+">"+'<div class="login_regular">'+'<form class="reg_form" method="post">'+"<table>"+"<tbody>"+"<tr>"+"<td>"+'<div class="login_phone bd_gray '+n+'">'+'<label class="uin_tips">请输入您的手机号码</label>'+'<div class="inputouter inputouter-icon">'+'<span class="login_icon login_icon_phone"></span> '+'<input type="text" name="mobile" class="txt-login-input login_numbel" autocomplete="false" maxlength="11" '+r+">"+"</div>"+"</div>"+"</td>"+"</tr>"+'<tr class="tr_vcode" style="display:none;">'+"<td  >"+'<div class="login_check_code">'+'<label class="uin_tips uin_tips_cod">请输入验证码</label>'+'<div class="inputouter">'+'<img width="85" height="30" src="'+e.imageCheckReg+'" style="cursor:pointer" id="'+e.name+'vcodeImg" class="f_r vcodeImg" alt="" title="看不清？换一个" >'+'<input type="text" class="txt-login-input" name="vcode">'+'<a class="btnChangeImg login_reset_check_code" href="javascript:;" name="QunarPopBoxvcodeImg">换一个</a>'+"</div>"+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td>"+'<div class="login_check_code clrfix">'+'<label class="uin_tips">请输入激活码</label>'+'<div class="inputouter txt_login_ym inputouter-icon">'+'<span class="login_icon login_icon_pass"></span> '+'<input type="text" class="txt-login-input txt_igin_ico" name="randcode">'+"</div>"+'<span data-type="getVerifyCode">'+'<a class="f_r login_icon login_btn_blue" href="javascript:;">获取手机激活码</a>'+"</span>"+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td>"+'<div class="login_notice reg_right"  data-type="notice" style="display:none;">'+'<i class="login_icon login_icon_error"></i>验证码输入错误，请重新输入'+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td>"+'<div class="login_submit">'+'<button class="login_icon login_btn_orange" type="submit" data-type="login">提 &nbsp; 交</button>'+"</div>"+"</td>"+"</tr>"+"<tr>"+"<td>"+s+"</td>"+"</tr>"+"</tbody>"+"</table>"+"</form>"+"</div>"+"</div>"+"</div>"+"</div>";return o}function u(e,t){t.find("[data-type='notice']").html('<div class="text">'+e+'</div><i class="login_icon login_icon_error"></i>');t.find("[data-type='notice']").show()}function a(e){e.find("[data-type='notice']").html("");e.find("[data-type='notice']").hide()}var r=QNRCorp.Tools;var i=QNRCorp.PopBox;var s=false;var o=null;e.RegPop=function(t){var n=window.location.host;var r="";if(t&&t.proxy&&t.proxy.indexOf("?")>-1){r=document.domain?"&d="+document.domain:""}else{r=document.domain?"?d="+document.domain:""}t.proxy=t.proxy?t.proxy+r:"/proxy.htm"+r;t.prior=t.prior?t.prior:"mobile";t.protocol="https:";t.logFlag=t.logFlag===undefined?true:t.logFlag;t.closeFlag=t.closeFlag===undefined?true:t.closeFlag;t.twoWeek=t.twoWeek===undefined?true:t.twoWeek;t.lostPass=t.lostPass===undefined?true:t.lostPass;t.skipBind=t.skipBind===undefined?false:t.skipBind;t.ret=t.ret===undefined?window.location.href:t.ret;t.display=t.display===undefined?"pop":t.display;t.isReg=t.isReg===undefined?false:t.isReg;t.origin=t.origin===undefined?false:t.origin;t.imageCheckLogin=(new CaptchaVcodeUrl(t.protocol,"login")).getAddr();t.imageCheckReg=(new CaptchaVcodeUrl(t.protocol,"register")).getAddr();if(t.url){QNRCorp.login.url=e.extend(QNRCorp.login.url,t.url)}if(t.union){t.width="655px"}else{t.width="352px"}o=this;o.options=t;o.init()};e.RegPop.fn=e.RegPop.prototype;e.RegPop.fn.init=function(){var e=o.options;if(e.type==="perfect"){e.title="完善信息";this.initSecond(e)}else{e.title="快速注册";this.initSecond(e)}o.isNeedRegCaptchaMobile()};e.RegPop.fn.initSecond=function(e){var t=o.getContent();e.content=t;e.title=e.title?e.title:"快速注册";o.popBox=new i(e);o.popBox.init();o._dom=o.popBox._dom;o.showEvent()};e.RegPop.fn.getContent=function(){o.options.name="QunarPopBox";o.options.className="q_widget_login q_widget_reg";var e=n(o.options);return e};e.RegPop.fn.checkMobile=function(t){var n=o.options.name?o.options.name:o.options.name;if(!r.util.validMobile(t)){var i="不是正确的手机格式";u(i,e("#"+n));e("#"+n).find("input[name='mobile']").parent().parent().addClass("login_active");return false}else{e("#"+n).find("[data-type='notice']").html("");e("#"+n).find("[data-type='notice']").hide();return true}};e.RegPop.fn.checkVcode=function(){var t=o.options.name?o.options.name:o.options.name;var n=e("#"+t).find("[name='vcode']").val();if(!e("#"+t).find(".tr_vcode").hasClass("needVcode")){return true}if(!r.util.validVcode(n)){var i="请输入图片验证码";u(i,e("#"+t));e("#"+t).find("[name='vcode']").addClass("login_active");return false}else{e("#"+t).find("[data-type='notice']").html("");e("#"+t).find("[data-type='notice']").hide();return true}};e.RegPop.fn.checkMobilePassword=function(t){var n=o.options.name?o.options.name:o.options.name;if(!r.util.validMobilePassword(t)){var i="请输入获取的动态密码";u(i,e("#"+n));e("#"+n).find("[name='randcode']").parent().addClass("login_active");return false}else{e("#"+n).find("[data-type='notice']").html("");e("#"+n).find("[data-type='notice']").hide();return true}};e.RegPop.fn.showEvent=function(){var t=o.options.name?o.options.name:o.options.name;var n=o.options;o._dom.find(".vcodeImg").bind("click",function(t){t.preventDefault();e(this).attr("src",n.imageCheckLogin+"&t="+(new Date).getTime())});o._dom.find(".btnChangeImg").bind("click",function(e){e.preventDefault();o.changeVcodeImg()});var r=e("#"+t).find("input[name='mobile']").val();if(r!=""){var i=e("#"+t).find("input[name='mobile']").parent().parent().find("label");i.hide()}e(".uin_tips").click(function(){e(this).parent().find(".txt-login-input").trigger("focus")});e("#"+t).find("input[type='text']").focus(function(){e(this).parent().parent().removeClass("login_active");e(this).parent().removeClass("login_active");e(this).removeClass("login_active");var t=e(this).parent().parent().find("label");t.addClass("focus")}).blur(function(){var n=e(this).parent().parent().find("label");if(e(this).val()===""){n.show();n.removeClass("focus")}else{var r=e(this).attr("name");if(r==="mobile"){var i=e("#"+t).find("input[name='mobile']").val();o.checkMobile(i)}else if(r==="vcode"){o.checkVcode("")}else if(r==="randcode"){var s=e("#"+t).find("input[name='randcode']").val();o.checkMobilePassword(s)}}}).keydown(function(){var t=e(this).parent().parent().find("label");if(e(this).val()!=""){t.hide()}}).keyup(function(){var t=e(this).parent().parent().find("label");if(e(this).val()!=""){t.hide()}}).change(function(){var t=e(this).parent().parent().find("label");if(e(this).val()!=""){t.hide()}});e("#"+t).find("[data-type='getVerifyCode']").bind("click",function(e){e.preventDefault();o.getVerifyCode()});e("#"+t).find("[data-type='login']").bind("click",function(e){e.preventDefault();o.register()});o.bindBtnGoLogin()};e.RegPop.fn.changeVcodeImg=function(){o._dom.find(".vcodeImg").attr("src","https://user.qunar.com/captcha/api/image?k={en7mni(z&p=ucenter_popup_register&c=99b054becba8690183f1f7f57e27a690&t="+(new Date).getTime())};e.RegPop.fn.getVerifyCode=function(){function r(){var r=e("#"+n).find("[data-type='count']").html();var i=parseInt(r);i=i-1;if(i>0){e("#"+n).find("[data-type='count']").html(i)}else{e("#"+n).find("[data-type='getVerifyCode']").html('<a class="right login_icon login_btn_blue" href="javascript:;" >免费获取</a>');clearInterval(t);e("#"+n).find("[data-type='getVerifyCode']").bind("click",function(){o.getVerifyCode()})}}var n=o.options.name?o.options.name:o.options.name;var i=e("#"+n).find("input[name='mobile']").val();var a=e("#"+n).find("input[name='vcode']").val();var f=o.checkMobile(i);if(!f){return}if(s){if(!o.checkVcode()){return}}var l={};l.mobile=i;l.vcode=a;var c={success:function(i){if(i.ret===true){e("#"+n).find("[data-type='getVerifyCode']").html('<span class="f_r login_btn_gray"><span data-type="count">59</span>秒后重新获取</span>');t=setInterval(r,1e3);e("#"+n).find("[data-type='getVerifyCode']").unbind()}else{var a=i.errmsg;if(i.errcode=="11002"){a='手机号码已存在，<a href="javascript:;" style="cursor:pointer" class="btn-gotologin">立即登录</a>'}u(a,e("#"+n));o.bindBtnGoLogin();o.changeVcodeImg()}if(i.data&&i.data.needCaptcha){s=true;e("#"+n).find(".tr_vcode").show().addClass("needVcode")}else{s=false;e("#"+n).find(".tr_vcode").hide().removeClass("needVcode")}},failure:function(e){throw new Error("failure: api status is "+e)}};var h=o.options;if(h.type==="perfect"){var p=new QNRCorp.login.LoginHandler(o.options.proxy);p.sendMobileCode(l,c)}else{l.action="register";var p=new QNRCorp.login.LoginHandler(o.options.proxy);p.popRegSendSms(l,c)}};e.RegPop.fn.register=function(){var t=o.options.name?o.options.name:o.options.name;var n=e("#"+t).find("input[name='mobile']").val();var r=o.checkMobile(n);if(!r){return}if(s){if(!o.checkVcode()){return}}var i=e("#"+t).find("input[name='randcode']").val();if(!o.checkMobilePassword(i)){return}var a={};a.mobile=n;var f={success:function(n){var r=n.data;var i=o.options.callback;if(n.ret===true){if(i){if(i.success){i.success.call(null,n,l.type)}else{i.call(null,n,l.type)}}if(o.popBox)o.popBox.close()}else{if(i){if(i.unsuccess){i.unsuccess.call(null,n,l.type)}else{i.call(null,n,l.type)}}var a=n.errmsg;u(a,e("#"+t));o.changeVcodeImg()}if(n.data&&n.data.needCaptcha){s=true;e("#"+t).find(".tr_vcode").show().addClass("needVcode")}else{s=false;e("#"+t).find(".tr_vcode").hide().removeClass("needVcode")}},failure:function(e){throw new Error("failure: api status is "+e)}};var l=o.options;if(l.origin){a.origin=l.origin}a.vcode=e("#"+t).find("input[name=vcode]").val();if(l.type==="perfect"){a.randcode=i;var c=new QNRCorp.login.LoginHandler(o.options.proxy);c.userExtBindAndLogin(a,f)}else{a.logincode=i;a.remember="0";a.action="register";var c=new QNRCorp.login.LoginHandler(o.options.proxy);c.popRegConfirm(a,f)}};e.RegPop.fn.isNeedRegCaptchaMobile=function(){var t=o.options;var n=t.name;e.getJSON("https://user.qunar.com/webApi/isRegNeedCaptcha.jsp?format=js&type=3&callback=?",function(t){if(t.data){s=true;e("#"+n).find(".tr_vcode").show()}else{s=false;e("#"+n).find(".tr_vcode").hide()}if(o.popBox)o.popBox.relocate()})};e.RegPop.fn.bindBtnGoLogin=function(){o._dom.find(".btn-gotologin").bind("click",function(){var t=o._dom.find("input[name=mobile]").val();if(o.popBox)o.popBox.rm();e(window).unbind("scroll.QNRCorp");var n=e.extend(o.options,{});n.type="login";var r=new e.LoginPop(n);r._dom.find("input[name=mobile]").val(t).trigger("change")})};window.RegPop=function(t){return new e.RegPop(t)}})(jQuery);(function($){function getLoginLayerHtml(e){var t=e.skipBind?"&reference=ext":"";var n=escape(encodeURIComponent(e.ret));var r=e.union?"login_content_lvtu":"";var i=e.union?"login_cut":"";var s=e.union?'<div class="login_unite">'+"<h2>用合作网站登录</h2>"+"<p>"+'<a href="https://oauth.qunar.com/oauth-client/sina/login?appname=www&ret='+n+"&method=login&vistor=https://"+userlogin_domain+"/oauth/login.jsp?"+t+'" class="login_icon login_btn_sina">新浪微博</a>'+"<p>"+'<a href="https://oauth.qunar.com/oauth-client/qq/login?ret='+n+"&method=login&vistor=https://"+userlogin_domain+"/oauth/login.jsp?"+t+'" class="login_icon login_btn_qq">QQ帐号</a>'+"</p>"+"</div>":"";var o=e.closeFlag?'<span id="'+e.name+'ClosePop" class="login_close login_icon">关闭</span>':"";var u=e.notice?'<div class="active-ts"><i class="login_icon login_icon_cue"></i><span>'+e.notice+"</span></div>":"";var a=e.mobile?"bd_gray_bag":"";var f=e.mobile?'readonly value="'+e.mobile+'"':"";var l=e.twoWeek?'<span class="f_l twoWeekLogin"><input type="checkbox" checked id="'+e.name+'auto_but" name="remember" class="login_icon_checked"><label for="'+e.name+'auto_but">'+languagePackage.LoginRemeber.loginAuto+"</label></span>":"";var c=e.lostPass?'<span id="remeber_pass" class="remeber_pass f_r"><a href="https://user.qunar.com/passport/forgotpwd.jsp" target="_blank">'+languagePackage.LoginRemeber.remeberPsw+"</a> </span>":"";var h=e.origin?"&origin="+e.origin:"";var p=e.regFlag?'<div class="fieldset clrfix f_r"><a class="f_r btn-gotoreg" target="_blank" href="https://user.qunar.com/passport/register.jsp?ret=http%3A%2F%2Fwww.qunar.com%2F"  >'+languagePackage.Register+"</a></div>":"";var d=e.display!="inner"?'<div class="'+e.className+'" style="width:'+e.width+';" id="'+e.name+'">':"";var v=e.display!="inner"?'<div class="login_content_head"><span>'+languagePackage.LoginTitle+"</span>"+o+"</div>"+u:"";var m=e.display!="inner"?"</div>":"";var g=["normal","mobile"],y=[languagePackage.LoginType.normal,languagePackage.LoginType.mobile],b=["",'style="display:none;"'];e.prior==="mobile"?(g=["mobile","normal"],y=[languagePackage.LoginType.mobile,languagePackage.LoginType.normal],b=['style="display:none;"',""]):"";var w=e.QR==="hidden"?'style="display:none;"':"";var E=e.regFlag?'|<a class="btn-gotoreg" target="_blank" href="https://user.qunar.com/passport/register.jsp?ret=http%3A%2F%2Fwww.qunar.com%2F">'+languagePackage.Register+"</a>":"";var S=e.regFlag?"":" hide";var x=d+'<div class="login_content '+r+'">'+v+'<div class="login_loading">'+'<img src="//source.qunarzz.com/usercenter/login/loading.gif">'+"</div>"+'<div class="login_content_body clrfix" style="display:none">'+"<!--二维码登录 begin-->"+'<div class="login_QR hide">'+'<div class="login_QR_body">'+'<p class="login_QR_title">手机扫描安全登录</p>'+'<div class="login_QR_imgs">'+'<p class="login_QR_imgs_loginTip ">客户端注册用户，请扫码登录<i></i></p>'+'<img src="//source.qunarzz.com/usercenter/login/loading.gif" class="login_QR_imgs_loading">'+'<span class="login_QR_imgs"></span>'+'<span class="login_QR_imgs_tips">'+'<span  class="login_QR_imgs_tips_inner"></span>'+"</span>"+"</div>"+'<p class="login_QR_tips"><a href="http://phone.qunar.com/" target="_blank">下载去哪儿APP，畅享聪明之旅</a></p>'+'<p class="login_QR_btns"><a class="login_QR_help_btn '+S+' " href="javascript:;">使用帮助</a>'+E+"</p>"+"</div>"+'<div class="login_QR_success hide">'+'<div class="clrfix login_QR_success_body">'+'<span class="f_l"><img src="//'+userlogin_domain+'/images/usercenter/login/QR_login_success.png"></span>'+'<div class="f_l login_QR_success_tips"><p class="login_QR_success_title">扫描成功</p><p>点击手机上的确认按钮即可登录</p></div>'+"</div>"+"</div>"+"</div>"+"<!--二维码登录 end-->"+'<div class="login_regular  normal_login  f_l '+i+'">'+'<form class="login_form" method="post" __action="https://'+userlogin_domain+'/webApi/logins.jsp">'+'<div class="login_type">'+'<span class="active f_l"> <input type="radio" data-type="'+g[0]+'" id="'+e.name+'ptlogin" value="'+g[0]+'" name="loginType" checked="checked">'+'<label for="'+e.name+'ptlogin">'+y[0]+"</label>"+"</span>"+'<span class="f_r"> <input type="radio" data-type="'+g[1]+'" id="'+e.name+'celogin" value="'+g[1]+'" name="loginType">'+'<label for="'+e.name+'celogin">'+y[1]+"</label> </span>"+"</div>"+"<!-- 普通登录 begin-->"+'<div class="login_name  bd_gray '+a+'" data-type="normal" '+b[0]+">"+'<label class="uin_tips">'+languagePackage.LoginInputTip.normal.username+"</label>"+'<div class="inputouter inputouter-icon">'+'<span class="login_icon login_icon_name"></span>'+'<input type="text" class="txt-login-input" name="username" '+f+' autocomplete="off">'+"</div>"+"</div>"+'<div class="clrfix username_halfLogin hide"><span>'+languagePackage.LoginInputTip.halfLogin.count+'</span><span class="maskKey_span"></span></div>'+'<div class="clrfix half-tip hide">'+languagePackage.LoginInputTip.halfLogin.pswTip+"</div>"+'<div class="login_pass bd_gray" data-type="normal" '+b[0]+">"+'<label class="uin_tips">'+languagePackage.LoginInputTip.normal.password+"</label>"+'<div class="inputouter inputouter-icon">'+'<span class="login_icon login_icon_pass"></span> <input type="password" class="txt-login-input" name="password" autocomplete="off">'+"</div>"+"</div>"+'<div class="login_check_code" data-type="normalVcode" style="display:none;" >'+'<label class="uin_tips uin_tips_cod">'+languagePackage.LoginInputTip.Vcode.content+"</label>"+'<div class="inputouter">'+'<img width="85" height="30" style="cursor:pointer" src="'+e.imageCheckLogin+'" id="'+e.name+'vcodeImg" class="vcodeImg f_r" alt="" title="'+languagePackage.LoginInputTip.Vcode.tip+'" >'+'<input type="text" class="txt-login-input" name="vcode" maxlength="4">  <a class="btnChangeImg login_reset_check_code" href="javascript:;" name="'+e.name+'vcodeImg">'+languagePackage.LoginInputTip.Vcode.changeVcode+"</a>"+"</div>"+"</div>"+"<!-- 普通登录 end-->"+"<!-- 动态密码登录 begin-->"+'<div class="login_name bd_gray '+a+'" data-type="mobile" '+b[1]+">"+'<label class="uin_tips">'+languagePackage.LoginInputTip.mobile.username+"</label>"+'<div class="inputouter inputouter-icon">'+'<span class="login_icon login_icon_name"></span>'+'<input type="text" class="txt-login-input" name="mobile" maxlength="11" '+f+">"+"</div>"+"</div>"+'<div class="login_check_code" data-type="mobileVcode" style="display:none;">'+'<label class="uin_tips uin_tips_cod">'+languagePackage.LoginInputTip.Vcode.content+"</label>"+'<div class="inputouter">'+'<img width="85" height="30" style="cursor:pointer" src="'+e.imageCheckLogin+'" id="'+e.name+'vcodeImgMobile" class="vcodeImgMobile f_r" alt="">'+'<input type="text" class="txt-login-input" name="vcodeMobile" maxlength="4"> <a class="btnChangeImgMobile login_reset_check_code" href="javascript:;" name="'+e.name+'vcodeImgMobile">'+languagePackage.LoginInputTip.Vcode.changeVcode+"</a>"+"</div>"+"</div>"+'<div class="login_check_code clrfix mobile_check_code" data-type="mobile" '+b[1]+">"+'<label class="uin_tips uin_tips">'+languagePackage.LoginInputTip.mobile.password+"</label>"+'<div class="inputouter txt_login_ym inputouter-icon">'+'<span class="login_icon login_icon_pass"></span> <input type="text" class="txt-login-input txt_igin_ico" name="randcode" maxlength="6">'+"</div>"+'<span data-type="getVerifyCode"> <a class="f_r login_icon login_btn_blue" href="javascript:;">'+languagePackage.ButtonVal.getVerifyCode+"</a> </span>"+"</div>"+"<!-- 动态密码登录 end-->"+'<div class="login_notice" data-type="notice" style="display:none;">'+'<i class="login_icon login_icon_cue"></i><div class="login_notice_text"></div>'+"</div>"+'<div class="login_remeber clrfix" name="login_remeber">'+c+l+"</div>"+'<div class="login_submit">'+'<button class="login_icon login_btn_orange" type="submit" data-type="login">'+languagePackage.ButtonVal.login+"</button>"+"</div>"+p+'<div class="regFlag_halfLogin hide clrfix"><a href="javascript:;" class="useOther_halfLogin_btn f_l">'+languagePackage.UseOtherLogin+"</a>"+'<a class="f_r btn-gotoreg" target="_blank" href="https://user.qunar.com/passport/register.jsp?ret=http%3A%2F%2Fwww.qunar.com%2F">'+languagePackage.Register+"</a></div>"+"</form>"+"<!--手机登陆-->"+"</div>"+s+"</div>"+'<div class="clrfix QR2PC_btn"'+w+'><a class="f_r"></a></div>'+"</div>"+m;return x}function checkHalfLogin(e){var t=$("#"+PopBoxDiv);var n="https://"+userlogin_domain+"/ajax/getLoginKey.jsp?format=js";$.ajax({url:n,type:"GET",dataType:"jsonp",success:function(n){if(n.data){var r=n.data.loginWay;if(r=="1"||r=="2"){maskKey=n.data.maskKey;realKey=n.data.realKey;prenum=n.data.code;var i=n.data.type.toString();var s=i==="1"?"+"+prenum+"-"+maskKey:maskKey;$(".maskKey_span").html(s);$(".login_regular").addClass("login_half");if(r=="1"){t.find("input[data-type=normal]").trigger("click")}else if(r=="2"){t.find("input[data-type=mobile]").trigger("click");t.find(".half-tip").html(languagePackage.LoginInputTip.halfLogin.vcodeTip)}$(".regFlag_halfLogin").removeClass("hide");$(".username_halfLogin").removeClass("hide");$(".half-tip").removeClass("hide");$(".login_type,.login_name,.fieldset").hide();t.find("button[type=submit]").html(languagePackage.ButtonVal.confirm);isHalfLogin=true}else if(r=="3"){var o=t.find(".QR2PC_btn a");if(o.hasClass("PC_btn")){return false}o.trigger("click");isHalfLogin=false}e(realKey)}else{}t.find(".login_loading").hide();$().fadeIn?t.find(".login_content_body").fadeIn(500):t.find(".login_content_body").show(500)}})}function resetLogin(){var e=$("#"+PopBoxDiv);isHalfLogin=false;$(".regFlag_halfLogin,.username_halfLogin,.half-tip").hide();$(".login_type").show();$(".login_name").show();$(".login_remeber").show();$(".fieldset").show();e.find(".login_type .f_l input[type=radio]").trigger("click");e.find("input[name=password]").val("");e.find("input[name=vcode]").val("");e.removeClass("login_half");$("#QunarPopBoxauto_but").attr("checked",true);e.find("button[type=submit]").html(languagePackage.ButtonVal.login)}function bindBlurNormal(){var e=_self.options.name?_self.options.name:_self.options.name;$("#"+e).find("input[type='text'],input[type='password']").bind("blur",function(t){var n=$(this).parent().parent().find("label");if($(this).val()===""){n.show();n.removeClass("focus")}else{var r=$(this).attr("name");if(r==="username"){var i=$("#"+e).find("input[name='username']").val();_self.checkEmailOrMobile(i);_self.isNeedCaptcha(i);if(_self.options.QR!=="hidden"){checkPswType(i)}}else if(r==="password"){var s=$("#"+e).find("input[name='password']").val();_self.checkPassword(s)}else if(r==="vcode"){_self.checkVcode("")}}})}function checkPswType(e){var t=_self.options.name?_self.options.name:_self.options.name;$.getJSON("https://"+userlogin_domain+"/webApi/getPwdType.jsp?username="+e+"&format=js&callback=?",function(e){if(e.data&&e.data.pwdType=="2"){var n=$("#"+t).find(".QR2PC_btn a");if(n.hasClass("PC_btn")){return false}$(".login_QR_imgs_loginTip").show();n.trigger("click")}})}function fnNoCaptcha(e,t){QNRCorp.rmcsdf(t)}function fnHover(e,t,n,r){var n={};var r=r||300;var i=e;if(t==="in"){n=$.extend({left:"0"},n)}else if(t=="out"){n=$.extend({left:"100%"},n)}i.animate(n,r,function(){if(t==="in"){$(".login_QR_imgs_tips_inner").show().animate({left:"65px"},r)}else if(t==="out"){$(".login_QR_imgs_tips_inner").hide().animate({left:"95px"},r)}})}function throttle(e){if(th_handler){clearTimeout(th_handler)}th_handler=setTimeout(function(){e();clearTimeout(th_handler)},300)}function errorCodeToMsg(e){return errorObj[e]}function showError(e,t){t.find("[data-type='notice']").html('<div class="login_notice_text">'+e+'</div><label style="display: none"></label><i class="login_icon login_icon_error"></i>');t.find("[data-type='notice']").show()}function clearAllError(e){e.find("[data-type='notice']").html("");e.find("[data-type='notice']").hide()}function getQRCode(){window.qr_timer=setTimeout(function(){getQRCode()},1e3*60*5);$.ajax({url:"https://"+userlogin_domain+"/qcode/getQcodeToken.jsp",callback:"callback",dataType:"jsonp",data:{channel:"www_pop",callbacktype:2,format:"js",type:3},success:function(data){var token=eval("("+data.result+")").data;var QRimg=$(".login_QR_imgs").find("img");QRimg.attr("src","https://user.qunar.com/qcode/show?token="+token+"&channel=www_pop").bind("load",function(){$(this).removeClass("login_QR_imgs_loading")});qcLogin(token,"https:")},error:function(e){}})}function createHot(){var e="<div class='login_QR_imgs_hot'>&nbsp;</div>";$(".login_QR_body").append(e);$(".login_QR_imgs_hot").css({position:"absolute",top:"45px",left:"50%","margin-left":"-75px","z-index":9,width:"150px",height:"150px"})}function qcLogin(e,t){var n=t+"//"+userlogin_domain+"/passport/qcodeLogin.jsp";var r=$.ajax({url:n,callback:"callback",dataType:"jsonp",data:{token:e,channel:"www_pop",format:"js",type:3},success:function(n){if(!$(".login_content").length||!$(".QR2PC_btn a").hasClass("PC_btn")){clearTimeout(qcLogin_timer);return}qcLogin_timer=setTimeout(function(){qcLogin(e,t)},500);if(n.ret){if(!window.startTime){window.startTime=+(new Date)}clearTimeout(window.qr_timer);$(".login_QR_body").addClass("hide");$(".login_QR_success").removeClass("hide");var r=+(new Date)-window.startTime;var i=9*60*1e3;if(r>i){getQRCode();$(".login_QR_body").removeClass("hide");$(".login_QR_success").addClass("hide");window.startTime="";clearTimeout(qcLogin_timer)}if(n.data.redirect){clearTimeout(qcLogin_timer);var s=_self.options.callback;var o=n.data;if(typeof s=="function")s.call(null,o);else if(typeof s=="object"){if(s.success){s.success.call(null,o)}}if(_self.popBox)_self.popBox.close()}}}});return r}var Tools=QNRCorp.Tools;var PopBox=QNRCorp.PopBox;var isNeedCaptcha=false;var isNeedCaptchaMobile=true;var _self=null;var isHalfLogin=false;var maskKey="";var realKey="";var prenum="86";var languagePackage={};var errorObj={};var PopBoxDiv={};var userlogin_domain="";$.LoginPop=function(e){var t=window.location.host;var n="";if(e&&e.proxy&&e.proxy.indexOf("?")>-1){n=document.domain?"&d="+document.domain:""}else{n=document.domain?"?d="+document.domain:""}e.proxy=e.proxy?e.proxy+n:"/proxy.htm"+n;e.prior=e.prior?e.prior:"normal";e.protocol="https:";e.regFlag=e.regFlag===undefined?true:e.regFlag;e.closeFlag=e.closeFlag===undefined?true:e.closeFlag;e.twoWeek=e.twoWeek===undefined?true:e.twoWeek;e.lostPass=e.lostPass===undefined?true:e.lostPass;e.skipBind=e.skipBind===undefined?false:e.skipBind;e.ret=e.ret===undefined?window.location.href:e.ret;e.display=e.display===undefined?"pop":e.display;e.isReg=e.isReg===undefined?false:e.isReg;e.origin=e.origin===undefined?false:e.origin;e.source=e.source==undefined?false:e.source;e.domain=userlogin_domain=e.domain?e.domain:"user.qunar.com";e.imageCheckLogin=(new CaptchaVcodeUrl(e.protocol,"login",userlogin_domain)).getAddr();e.imageCheckReg=(new CaptchaVcodeUrl(e.protocol,"register",userlogin_domain)).getAddr();e.timeout=e.timeout?true:false;var r="Chinese";languagePackage=QNRCorp.MultiLanguage[e.i18nLanguage]?QNRCorp.MultiLanguage[e.i18nLanguage]:QNRCorp.MultiLanguage[r];errorObj=QNRCorp.LoginPopError[e.i18nLanguage]?QNRCorp.LoginPopError[e.i18nLanguage]:QNRCorp.LoginPopError[r];if(e.url){QNRCorp.login.url=$.extend(QNRCorp.login.url,e.url)}if(e.union){e.width="655px"}else{e.width="352px"}_self=this;_self.options=e;if(e.type==="reg"||e.type==="perfect"){new $.RegPop(e)}else if(e.type==="bind"){var i=new QNRCorp.BindMobile(e);i.init()}else{_self.init()}};$.LoginPop.fn=$.LoginPop.prototype;$.LoginPop.fn.init=function(){var e=_self.options;var t=_self.getContent();_self.isNeedCaptcha();_self.isNeedCaptchaMobile();if(e.display==="inner"){_self._dom=$(t);$("#"+_self.options.name).html(_self._dom)}else{e.content=t;_self.popBox=new PopBox(e);_self.popBox.init();_self._dom=_self.popBox._dom}if(_self.options.union){$(".login_regular").css("float","left")}_self.showEvent();setTimeout(function(){checkHalfLogin(_self.isNeedCaptcha)},0);if(e.prior==="mobile"){_self.bindMobile()}else{_self.bindNormal()}};$.LoginPop.fn.isNeedCaptcha=function(e){var t=_self.options;var n=t.name;var e=e?{username:e}:{};$.getJSON("https://"+userlogin_domain+"/webApi/isNeedCaptcha.jsp?format=js&callback=?",e,function(e){if(e.data){isNeedCaptcha=true;if(t.prior!="mobile"){$("#"+n).find("div[data-type='normalVcode']").show()}}else{isNeedCaptcha=false;$("#"+n).find("div[data-type='normalVcode']").hide()}if(_self.popBox){_self.popBox.relocate()}})};$.LoginPop.fn.isNeedCaptchaMobile=function(){var e=_self.options;var t=e.name;$.getJSON("https://"+userlogin_domain+"/webApi/isNeedCaptcha.jsp?format=js&type=3&callback=?",function(n){if(n.data){isNeedCaptchaMobile=true;if(e.prior==="mobile"){$("#"+t).find("div[data-type='mobileVcode']").slideDown(300)}}else{isNeedCaptchaMobile=false;$("#"+t).find("div[data-type='mobileVcode']").hide()}})};$.LoginPop.fn.getContent=function(){_self.options.name="QunarPopBox";_self.options.mask=true;_self.options.className="q_widget_login";PopBoxDiv=_self.options.name;var e=getLoginLayerHtml(_self.options);return e};$.LoginPop.fn.showEvent=function(){var e=_self.options.name?_self.options.name:_self.options.name;var t=_self.options;$("#"+e).find("#"+e+"vcodeImg,#"+e+"vcodeImgMobile,#HalfLoginvcodeImg").bind("click",function(e){e.preventDefault();var n=$(this).attr("id");$("#"+n).attr("src",t.imageCheckLogin+"&t="+(new Date).getTime())});$("#"+e).find("a[name='"+e+"vcodeImg'],a[name='"+e+"vcodeImgMobile']").bind("click",function(e){e.preventDefault();var t=$(this).siblings("img");t.trigger("click")});$(".QR2PC_btn").find("a").bind("click",function(){var e=$(this);if(e.hasClass("PC_btn")){$(".login_QR_imgs_loginTip").hide();$(".login_regular ").show();$(".login_QR").addClass("hide")}else{$(".login_regular ").hide();$(".login_QR").removeClass("hide");$(".login_QR_body").removeClass("hide");$(".login_QR_success").addClass("hide");_self.options.union&&$(".login_QR").addClass("QR_Union");getQRCode()}e.toggleClass("PC_btn")});$(".useOther_halfLogin_btn").bind("click",function(){resetLogin()});$("#"+e).delegate(".login_QR_help_btn,.login_QR_imgs","mouseover",function(){throttle(function(){var e=$(".login_QR_imgs_tips");fnHover(e,"in")})});$("#"+e).delegate(".login_QR_help_btn,.login_QR_imgs","mouseout",function(){throttle(function(){var e=$(".login_QR_imgs_tips");fnHover(e,"out")})});$("#"+e).find("input[name='loginType']").bind("click",function(){var n=$(this).val();if(n==="normal"){$("#"+e+"vcodeImg").trigger("click");$("#"+e).find("input[name='loginType']").closest("span").removeClass("active");$(this).closest("span").addClass("active");$("#remeber_pass").html('<a href="https://'+userlogin_domain+'/passport/forgotpwd.jsp" target="_blank">'+languagePackage.LoginRemeber.remeberPsw+"</a>");$("#"+e).find("div[data-type='normal']").show();if(isNeedCaptcha){$("#"+e).find("div[data-type='normalVcode']").show()}$("#"+e).find("div[data-type='mobile']").hide();$("#"+e).find("div[data-type='mobileVcode']").hide();_self.bindNormal();$("#"+e).find("[data-type='notice']").html("");$("#"+e).find("[data-type='notice']").hide();$("#"+e).find("div[name='login_remeber']").show();$("#remeber_pass").show()}else if(n==="mobile"){$("#"+e+"vcodeImgMobile").trigger("click");$("#"+e).find("input[name='loginType']").closest("span").removeClass("active");$(this).closest("span").addClass("active");if(_self.options.twoWeek){$("#remeber_pass").html('<a href="https://'+userlogin_domain+'/passport/forgotpwd.jsp" target="_blank">'+languagePackage.LoginRemeber.remeberPsw+"</a>")}else{$("#"+e).find("div[name='login_remeber']").hide()}if(isNeedCaptchaMobile){$("#"+e).find("div[data-type='mobileVcode']").show()}$("#"+e).find("div[data-type='normal']").hide();$("#"+e).find("div[data-type='normalVcode']").hide();$("#"+e).find("div[data-type='mobile']").show();_self.bindMobile();$("#"+e).find("[data-type='notice']").html("");$("#"+e).find("[data-type='notice']").hide();$("#remeber_pass").hide()}t.prior=n});$("#"+e).find("[data-type='login']").bind("click",function(e){e.preventDefault();_self.login()}).bind("mouseover",function(t){$("#"+e).find("input[type='text'],input[type='password']").unbind("blur")}).bind("mouseout",function(e){bindBlurNormal()});_self.bindBtnGoReg()};$.LoginPop.fn.checkEmailOrMobile=function(e){var t=_self.options.name?_self.options.name:_self.options.name;if(!Tools.util.validUsername(e)&&!Tools.util.validMobile(e)&&!Tools.util.validEmail(e)){var n=languagePackage.errorTip.normal.username.content;showError(n,$("#"+t));$("#"+t).find("input[name='username']").parent().parent().addClass("login_active");return false}else{$("#"+t).find("[data-type='notice']").html("");$("#"+t).find("[data-type='notice']").hide();return true}};$.LoginPop.fn.checkMobile=function(e){var t=_self.options.name?_self.options.name:_self.options.name;if(!Tools.util.validMobile(e)){var n=languagePackage.errorTip.mobile.username.content;showError(n,$("#"+t));$("#"+t).find("input[name='mobile']").parent().parent().addClass("login_active");return false}else{$("#"+t).find("[data-type='notice']").html("");$("#"+t).find("[data-type='notice']").hide();return true}};$.LoginPop.fn.checkPassword=function(e){var t=_self.options.name?_self.options.name:_self.options.name;if(!Tools.util.validPassword(e)){var n=languagePackage.errorTip.normal.password.content;if(!$.trim(e)){n=languagePackage.errorTip.normal.password.empty}showError(n,$("#"+t));$("#"+t).find("input[name='password']").parent().parent().addClass("login_active");return false}else{$("#"+t).find("[data-type='notice']").html("");$("#"+t).find("[data-type='notice']").hide();return true}};$.LoginPop.fn.checkMobilePassword=function(e){var t=_self.options.name?_self.options.name:_self.options.name;if(!Tools.util.validMobilePassword(e)){var n=languagePackage.errorTip.mobile.VerifyCode.empty;showError(n,$("#"+t));$("#"+t).find("[name='randcode']").parent().addClass("login_active");return false}else{$("#"+t).find("[data-type='notice']").html("");$("#"+t).find("[data-type='notice']").hide();return true}};$.LoginPop.fn.checkVcode=function(e){var t=_self.options.name?_self.options.name:_self.options.name;if(e=="Normal"){e=""}var n=$("#"+t).find("[name='vcode"+e+"']").val();if(!Tools.util.validVcode(n)){var r="";if(n.length==0){r=languagePackage.errorTip.normal.Vcode.empty}else{r=languagePackage.errorTip.normal.Vcode.content}showError(r,$("#"+t));if(e=="Normal"){$("[data-type='normalVcode']").show()}$("#"+t).find("[name='vcode"+e+"']").addClass("login_active");return false}else{$("#"+t).find("[data-type='notice']").html("");$("#"+t).find("[data-type='notice']").hide();return true}};$.LoginPop.fn.bindBtnGoReg=function(){var e=_self.options.name?_self.options.name:_self.options.name};$.LoginPop.fn.bindNormal=function(){function i(){$("#"+e).find("input[name='username']").trigger("change");$("#"+e).find("input[type='password']").trigger("change")}var e=_self.options.name?_self.options.name:_self.options.name;var t=$("#"+e).find("input[name='username']").val();if(t!=""){var n=$("#"+e).find("input[name='username']").parent().parent().find("label");n.hide()}var r=$("#"+e).find("input[name='password']").val();if(r!=""){var n=$("#"+e).find("input[name='password']").parent().parent().find("label");n.hide()}$(".uin_tips").click(function(){$(this).parent().find(".txt-login-input").trigger("focus")});$("#"+e).find("input[type='text'],input[type='password']").focus(function(){$(this).parent().parent().removeClass("login_active");$(this).parent().removeClass("login_active");$(this).removeClass("login_active");var e=$(this).parent().parent().find("label");e.addClass("focus")}).keydown(function(){var e=$(this).parent().parent().find("label");if($(this).val()!=""){e.hide()}}).keyup(function(){var e=$(this).parent().parent().find("label");if($(this).val()!=""){e.hide()}}).change(function(){var e=$(this).parent().parent().find("label");if($(this).val()!=""){e.hide()}});setTimeout(i,500);bindBlurNormal()};$.LoginPop.fn.bindMobile=function(){var e=_self.options.name?_self.options.name:_self.options.name;var t=$("#"+e).find("input[name='mobile']").val();if(t!=""){var n=$("#"+e).find("input[name='mobile']").parent().parent().find("label");n.hide()}$(".uin_tips").click(function(){$(this).parent().find(".txt-login-input").trigger("focus")});$("#"+e).find("input[type='text']").focus(function(){$(this).parent().parent().find(".login_active").removeClass("login_active");var e=$(this).parent().parent().find("label");e.addClass("focus")}).keydown(function(){var e=$(this).parent().parent().find("label");if($(this).val()!=""){e.hide()}}).keyup(function(){var e=$(this).parent().parent().find("label");if($(this).val()!=""){e.hide()}}).change(function(){var e=$(this).parent().parent().find("label");if($(this).val()!=""){e.hide()}});bindBlurNormal();$("#"+e).find("[data-type='getVerifyCode']").bind("click",function(e){e.preventDefault();_self.getVerifyCode()})};$.LoginPop.fn.login=function(){function e(e){var t=document.getElementsByName(e);for(i=0;i<t.length;i++){if(t[i].checked){return t[i].value}}return"undefined"}var t=e("loginType");if(t==="normal"){_self.loginNormal()}else if(t==="mobile"){_self.loginMobile()}};$.LoginPop.fn.getVerifyCode=function(){function i(){var t=$("#"+e).find("[data-type='count']").html();var r=parseInt(t);r=r-1;if(r>0){$("#"+e).find("[data-type='count']").html(r)}else{$("#"+e).find("[data-type='getVerifyCode']").html('<a class="f_r login_icon login_btn_blue" href="javascript:;" style="top:3px;">'+languagePackage.ButtonVal.getVerifyCode+"</a>");clearInterval(n);$("#"+e).find("[data-type='getVerifyCode']").bind("click",function(){_self.getVerifyCode()})}}var e=_self.options.name?_self.options.name:_self.options.name;var t=_self.options.isReg;var n=null;var r=$("#"+e).find("input[name='mobile']").val();if(isHalfLogin){r=realKey}if(!_self.checkMobile(r)){return}if(isNeedCaptchaMobile){if(!_self.checkVcode("Mobile")){return}}var s={};s.mobile=r;s.vcode=$("#"+e).find("[name='vcodeMobile']").val();if(t){s.action="register";s.type="implicit"}var o={success:function(t){if(t.ret===true){$("#"+e).find("[data-type='getVerifyCode']").html('<span class="f_r login_btn_gray"><span data-type="count">59</span>'+languagePackage.ButtonVal.count+"</span>");n=setInterval(i,1e3);$("#"+e).find("[data-type='getVerifyCode']").unbind();$("#"+e).find(".login_active").removeClass("login_active");$("#"+e).find("[data-type='notice']").hide();$("#"+e).find("[data-type='notice']").html("")}else{if(t.errcode==21006){$("#"+e+"vcodeImgMobile").trigger("click");var r=languagePackage.errorTip.mobile.register+'<a href="https://user.qunar.com/passport/register.jsp?ret=http%3A%2F%2Fwww.qunar.com%2F" style="cursor:pointer" class="btn-gotoreg" target="_blank">'+languagePackage.Register+"</a>";showError(r,$("#"+e));_self.bindBtnGoReg()}else{$("#"+e+"vcodeImgMobile").trigger("click");var s=errorCodeToMsg(t.errcode);showError(s,$("#"+e))}}if(t.data.needCaptcha){isNeedCaptchaMobile=true;$("#"+e).find("div[data-type='mobileVcode']").show()}else{isNeedCaptchaMobile=false;$("#"+e).find("div[data-type='mobileVcode']").hide()}},failure:function(e){throw new Error("failure: api status is "+e)}};fnNoCaptcha(s,function(){var e=new QNRCorp.login.LoginHandler(_self.options.proxy,userlogin_domain);e.getVerifyCode(s,o)})};$.LoginPop.fn.loginNormal=function(){var e=_self.options.name?_self.options.name:_self.options.name;var t=_self.options.origin;var n=_self.options.source;var r=_self.options.beforeLoginHandler;var i=$("#"+e).find("input[name='username']").val();var s=$("#"+e).find("input[name='password']").val();var o=$("#"+e).find("input[name='remember']").attr("checked");if(isHalfLogin){i=realKey}o=o?"1":"0";if(!_self.checkEmailOrMobile(i)){return}if(!_self.checkPassword(s)){return}if(isNeedCaptcha){if(!_self.checkVcode("Normal")){return}}var u={};u.username=i;u.password=s;u.remember=o;u.prenum=prenum;u.isHalfLogin=isHalfLogin;if(t){u.origin=t}if(n){u.source=n}u.vcode=$("#"+e).find("[name='vcode']").val();$("#"+e).find("[name='vcode']").val("");if(r&&typeof r==="function"){if(false===r(u,"loginNormal")){return}}var a={success:function(t){var n=t.data;var r=_self.options.callback;if(t.ret===true){if(typeof r=="function")r.call(null,n);else if(typeof r=="object"){if(r.success){r.success.call(null,n)}}if(_self.popBox)_self.popBox.close()}else{if(typeof r=="object"){if(r.unsuccess){r.unsuccess.call(null,t,"loginNormal")}else{}}if(t.errcode==21035){var i='风险账号，点击使用<a class="needvcodelogin js-needvcodelogin">手机动态码</a>登录',s;s=i;showError(s,$("#"+e));if($(".js-needvcodelogin").length>0){$(".js-needvcodelogin").bind("click",function(){resetLogin();$("#QunarPopBoxcelogin").trigger("click");var e=/^1\d{10}$/;if(e.test($("input[name='username']").val())){$("input[name='mobile']").val($("input[name='username']").val());$("input[name='mobile']").change()}})}}else{var s=errorCodeToMsg(t.errcode);showError(s,$("#"+e));$("#"+e+"vcodeImg").trigger("click")}}if(t.data&&t.data.needCaptcha){isNeedCaptcha=true;$("#"+e).find("div[data-type='normalVcode']").show()}else{isNeedCaptcha=false;$("#"+e).find("div[data-type='normalVcode']").hide()}},failure:function(e){throw new Error("failure: api status is "+e)}};fnNoCaptcha(u,function(){var e=new QNRCorp.login.LoginHandler(_self.options.proxy,userlogin_domain);e.loginNormal(u,a)})};$.LoginPop.fn.loginMobile=function(e){var t=_self.options.name?_self.options.name:_self.options.name;var n=_self.options.isReg;var r=_self.options.origin;var i=_self.options.source;var s=_self.options.beforeLoginHandler;var o=$("#"+t).find("input[name='mobile']").val();var u=$("#"+t).find("input[name='randcode']").val();if(isHalfLogin){o=realKey}if(!_self.checkMobile(o)){return}if(isNeedCaptchaMobile){if(!_self.checkVcode("Mobile")){return}}if(!_self.checkMobilePassword(u)){return}var a=$("#"+t).find("input[name='remember']").attr("checked");a=a?"1":"0";var f={};f.mobile=o;f.logincode=u;f.remember=a;f.prenum=prenum;f.isHalfLogin=isHalfLogin;f.vcode=$("#"+t).find("[name='vcodeMobile']").val();if(n){f.action="register"}if(r){f.origin=r}if(i){f.source=i}if(s&&typeof s==="function"){if(false===s(f,"loginMobile")){return}}var l={success:function(e){var n=e.data;var r=_self.options.callback;if(e.ret===true){if(typeof r=="function")r.call(null,n);else if(typeof r=="object"){if(r.success){r.success.call(null,n)}}if(_self.popBox)_self.popBox.close()}else{if(typeof r=="object"){if(r.unsuccess){r.unsuccess.call(null,e,"loginNormal")}else{}}var i=errorCodeToMsg(e.errcode);showError(i,$("#"+t));$("#"+t+"vcodeImgMobile").trigger("click")}if(e.data&&e.data.needCaptcha){isNeedCaptchaMobile=true;$("#"+t).find("div[data-type='mobileVcode']").show()}else{isNeedCaptchaMobile=false;$("#"+t).find("div[data-type='mobileVcode']").hide()}},failure:function(e){throw new Error("failure: api status is "+e)}};fnNoCaptcha(f,function(){var e=new QNRCorp.login.LoginHandler(_self.options.proxy,userlogin_domain);e.loginMobile(f,l)})};var th_handler=null;window.LoginPop=function(e){return new $.LoginPop(e)};var qcLogin_timer=null})(jQuery);(function(){var e="1.1.6_2015/05/18",t="1.1.6",n=QNRCorp.USERLOGIN_BEACON;if(window.console&&window.console.log){window.console.log("loginpop:"+e)}n.versionStatistics(t)})()